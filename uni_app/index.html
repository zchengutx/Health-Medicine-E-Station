<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ÂÅ•Â∫∑ÂåªÁñóÈ©øÁ´ô - È¶ñÈ°µ</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üè•</text></svg>">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background-color: #f5f5f5;
            color: #333;
        }

        .index-page {
            min-height: 100vh;
        }

        .status-bar {
            height: 44px;
            background-color: #e74c3c;
        }

        .header {
            display: flex;
            align-items: center;
            padding: 15px 20px;
            background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
            color: white;
        }

        .location {
            display: flex;
            align-items: center;
            margin-right: 15px;
            font-size: 14px;
            cursor: pointer;
        }

        .location-icon {
            font-size: 12px;
            margin-right: 4px;
        }

        .location-arrow {
            font-size: 10px;
            margin-left: 4px;
        }

        .search-bar {
            flex: 1;
            display: flex;
            align-items: center;
            background: white;
            border-radius: 25px;
            padding: 10px 15px;
            margin: 0 15px;
            cursor: pointer;
        }

        .search-icon {
            font-size: 14px;
            color: #999;
            margin-right: 8px;
        }

        .search-placeholder {
            font-size: 14px;
            color: #999;
        }

        .header-right {
            display: flex;
            align-items: center;
        }

        .notification-icon {
            font-size: 18px;
            cursor: pointer;
        }

        .quick-search {
            background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
            padding: 15px 0;
            overflow-x: auto;
            white-space: nowrap;
        }

        .search-tags {
            display: flex;
            padding: 0 20px;
        }

        .tag {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            padding: 6px 12px;
            border-radius: 15px;
            font-size: 12px;
            margin-right: 12px;
            white-space: nowrap;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        .tag:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        .main-banner {
            height: 200px;
            margin: 15px 20px;
            border-radius: 15px;
            overflow: hidden;
            position: relative;
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%);
        }

        .banner-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .banner-content {
            position: absolute;
            top: 20px;
            left: 20px;
            color: white;
        }

        .banner-title {
            display: block;
            font-size: 12px;
            margin-bottom: 5px;
            opacity: 0.9;
        }

        .banner-subtitle {
            display: block;
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 8px;
        }

        .banner-tag {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            padding: 4px 8px;
            border-radius: 8px;
            font-size: 10px;
        }

        /* ÂåªÁîüÂú®Á∫øÂíåËçØÂ∏àÊåáÂØºÊ†∑Âºè */
        .consultation-section {
            display: flex;
            gap: 15px;
            margin: 15px;
        }

        .consultation-card {
            flex: 1;
            background: white;
            border-radius: 12px;
            padding: 20px;
            cursor: pointer;
            transition: transform 0.2s;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .consultation-card:hover {
            transform: translateY(-2px);
        }

        .consultation-card.doctor {
            border-left: 4px solid #e74c3c;
        }

        .consultation-card.pharmacist {
            border-left: 4px solid #27ae60;
        }

        .consultation-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .consultation-text h3 {
            font-size: 16px;
            font-weight: bold;
            color: #333;
            margin-bottom: 5px;
        }

        .consultation-text p {
            font-size: 12px;
            color: #666;
            margin: 0;
        }

        .consultation-icon {
            position: relative;
        }

        .doctor-avatar,
        .pharmacist-avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: #f8f9fa;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
        }

        .consultation-badge {
            position: absolute;
            top: -5px;
            right: -5px;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #e74c3c;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 10px;
        }

        .pharmacist .consultation-badge {
            background: #27ae60;
        }

        .featured-categories {
            display: flex;
            padding: 0 20px;
            margin-bottom: 20px;
            gap: 10px;
        }

        .category-card {
            flex: 1;
            background: white;
            padding: 20px 15px;
            border-radius: 12px;
            text-align: center;
            position: relative;
            cursor: pointer;
            transition: transform 0.2s;
        }

        .category-card:hover {
            transform: translateY(-2px);
        }

        .category-icon {
            margin-bottom: 10px;
        }

        .icon {
            font-size: 24px;
        }

        .category-name {
            display: block;
            font-size: 13px;
            color: #333;
            margin-bottom: 5px;
        }

        .category-tag {
            background: #e74c3c;
            color: white;
            padding: 3px 6px;
            border-radius: 6px;
            font-size: 10px;
            position: absolute;
            top: 10px;
            right: 10px;
        }

        .category-nav {
            background: white;
            padding: 20px;
            margin-bottom: 15px;
        }

        .category-item {
            display: inline-block;
            width: 20%;
            text-align: center;
            margin-bottom: 20px;
            cursor: pointer;
            transition: transform 0.2s;
        }

        .category-item:hover {
            transform: scale(1.05);
        }

        .category-icon-circle {
            width: 40px;
            height: 40px;
            background: #f8f9fa;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 8px;
        }

        .category-icon-circle .icon {
            font-size: 18px;
        }

        .category-label {
            font-size: 12px;
            color: #666;
        }

        .product-section {
            background: white;
            padding: 20px;
            margin-bottom: 15px;
        }

        .loading-state, .error-state {
            text-align: center;
            padding: 40px 20px;
            color: #666;
        }

        .loading-spinner {
            font-size: 24px;
            margin-bottom: 10px;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .loading-text, .error-text {
            font-size: 14px;
            color: #999;
        }

        .error-icon {
            font-size: 24px;
            margin-bottom: 10px;
        }

        .retry-button {
            margin-top: 15px;
            padding: 8px 20px;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            transition: background-color 0.2s;
        }

        .retry-button:hover {
            background-color: #0056b3;
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .section-title {
            font-size: 16px;
            font-weight: bold;
            color: #333;
        }

        .section-more {
            font-size: 13px;
            color: #999;
            cursor: pointer;
        }

        .product-list {
            display: flex;
            flex-direction: column;
            gap: 15px;
            padding-bottom: 10px;
        }

        .product-item {
            display: flex;
            background: white;
            border-radius: 12px;
            overflow: hidden;
            cursor: pointer;
            transition: transform 0.2s;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            padding: 15px;
            align-items: center;
            gap: 15px;
        }

        .product-item:hover {
            transform: translateY(-2px);
        }

        .product-image {
            width: 100%;
            height: 120px;
            object-fit: cover;
        }

        .product-image-placeholder {
            width: 80px;
            height: 80px;
            background: linear-gradient(135deg, #ff6b6b, #4ecdc4);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 32px;
            color: white;
            border-radius: 12px;
            flex-shrink: 0;
        }

        .product-info {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .product-name {
            font-size: 16px;
            font-weight: 600;
            color: #333;
            margin: 0;
            line-height: 1.3;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .product-desc {
            font-size: 14px;
            color: #666;
            margin: 0;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .product-price {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-top: 5px;
        }

        .price {
            font-size: 16px;
            color: #e74c3c;
            font-weight: bold;
            margin-right: 5px;
        }

        .original-price {
            font-size: 12px;
            color: #999;
            text-decoration: line-through;
        }

        .new-user-banner {
            background: #e74c3c;
            margin: 0 20px 20px;
            border-radius: 12px;
            padding: 20px;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        .new-user-banner:hover {
            background: #c0392b;
        }

        .banner-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            color: white;
        }

        .banner-text {
            font-size: 14px;
            font-weight: bold;
        }

        .banner-more {
            font-size: 13px;
            opacity: 0.8;
        }

        /* ÊªöÂä®Êù°Ê†∑Âºè */
        .quick-search::-webkit-scrollbar,
        .product-list::-webkit-scrollbar {
            display: none;
        }

        /* ÂìçÂ∫îÂºèËÆæËÆ° */
        @media (max-width: 480px) {
            .featured-categories {
                flex-wrap: wrap;
            }
            
            .category-card {
                flex: 1 1 calc(50% - 5px);
                margin-bottom: 10px;
            }
            
            .category-item {
                width: 25%;
            }
        }

        /* Â∫ïÈÉ®ÂØºËà™Ê†èÊ†∑Âºè */
        .tabbar {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: white;
            border-top: 1px solid #eee;
            display: flex;
            height: 60px;
            z-index: 1000;
        }

        .tab-item {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: color 0.3s;
            color: #999;
            position: relative;
        }

        .tab-item.active {
            color: #e74c3c;
        }

        .tab-icon {
            font-size: 20px;
            margin-bottom: 4px;
        }

        .tab-text {
            font-size: 12px;
        }

        .tab-badge {
            position: absolute;
            top: 8px;
            right: 50%;
            transform: translateX(50%);
            background: #e74c3c;
            color: white;
            border-radius: 10px;
            padding: 2px 6px;
            font-size: 10px;
            min-width: 16px;
            text-align: center;
        }

        /* ‰∏∫Â∫ïÈÉ®ÂØºËà™Ê†èÁïôÂá∫Á©∫Èó¥ */
        .index-page {
            padding-bottom: 60px;
        }
    </style>
</head>
<body>
    <div class="index-page">
        <!-- È°∂ÈÉ®Áä∂ÊÄÅÊ†è -->
        <div class="status-bar"></div>
        
        <!-- È°∂ÈÉ®ÂØºËà™Ê†è -->
        <div class="header">
            <!-- ‰ΩçÁΩÆÈÄâÊã© -->
            <div class="location" onclick="selectLocation()">
                <span class="location-icon">üìç</span>
                <span class="location-text" id="currentLocation">‰∏úÂüéÂå∫</span>
                <span class="location-arrow">‚ñº</span>
            </div>
            
            <!-- ÊêúÁ¥¢Ê†è -->
            <div class="search-bar" onclick="goToSearch()">
                <span class="search-icon">üîç</span>
                <span class="search-placeholder">ÊêúÁ¥¢ËçØÂìÅ„ÄÅÁóáÁä∂„ÄÅÂìÅÁâå</span>
            </div>
            
            <!-- Âè≥‰æßÂõæÊ†á -->
            <div class="header-right">
                <div class="notification" onclick="goToNotification()">
                    <span class="notification-icon">üìß</span>
                </div>
            </div>
        </div>

        <!-- Âø´ÈÄüÊêúÁ¥¢Ê†áÁ≠æ -->
        <div class="quick-search">
            <div class="search-tags">
                <div class="tag" onclick="searchByTag('ÁúºËçØÊ∞¥')">ÁúºËçØÊ∞¥</div>
                <div class="tag" onclick="searchByTag('ÁõäÁîüËèå')">ÁõäÁîüËèå</div>
                <div class="tag" onclick="searchByTag('Âè∏ÁæéÊ†ºÈ≤ÅËÇΩ')">Âè∏ÁæéÊ†ºÈ≤ÅËÇΩ</div>
                <div class="tag" onclick="searchByTag('‰∏≠Êöë')">‰∏≠Êöë</div>
                <div class="tag" onclick="searchByTag('ÊµÅÊÑü')">ÊµÅÊÑü</div>
                <div class="tag" onclick="searchByTag('ÂáèËÇ•')">ÂáèËÇ•</div>
            </div>
        </div>

        <!-- ‰∏ªËΩÆÊí≠Âõæ -->
        <div class="main-banner" onclick="handleBannerClick()">
            <div class="banner-content">
                <span class="banner-title">Á´ãÁßãÁ¶èÂà© ÂÅ•Â∫∑Êç¢Â≠£</span>
                <span class="banner-subtitle">ÂÅ•Â∫∑Â•ΩÁâ©‰∏ìÂú∫</span>
                <div class="banner-tag">ÈÉ®ÂàÜÊª°78Âáè10/168Âáè20</div>
            </div>
        </div>

        <!-- ÂåªÁîüÂú®Á∫øÂíåËçØÂ∏àÊåáÂØº -->
        <div class="consultation-section">
            <div class="consultation-card doctor" onclick="goToDoctorConsultation()">
                <div class="consultation-content">
                    <div class="consultation-text">
                        <h3>ÂåªÁîüÂú®Á∫ø</h3>
                        <p>ÂÖçË¥πÂí®ËØ¢</p>
                    </div>
                    <div class="consultation-icon">
                        <div class="doctor-avatar">üë®‚Äç‚öïÔ∏è</div>
                        <div class="consultation-badge">üè•</div>
                    </div>
                </div>
            </div>
            <div class="consultation-card pharmacist" onclick="goToPharmacistGuidance()">
                <div class="consultation-content">
                    <div class="consultation-text">
                        <h3>ËçØÂ∏àÊåáÂØº</h3>
                        <p>‰∏ì‰∏öËçØÂ∏àÊåáÂØº</p>
                    </div>
                    <div class="consultation-icon">
                        <div class="pharmacist-avatar">üë©‚Äç‚öïÔ∏è</div>
                        <div class="consultation-badge">üíä</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ÁâπËâ≤ÂàÜÁ±ª -->
        <div class="featured-categories">
            <div class="category-card" onclick="goToCategory(1, 'ÂÆ∂Â∫≠Â∏∏Â§á')">
                <div class="category-icon">
                    <span class="icon">üë®‚Äçüë©‚Äçüëß‚Äçüë¶</span>
                </div>
                <span class="category-name">ÂÆ∂Â∫≠Â∏∏Â§á</span>
                <div class="category-tag">ÈÉ®ÂàÜÊª°78Âáè10</div>
            </div>
            <div class="category-card" onclick="goToCategory(2, 'ÂÑøÁ´•ÂÅ•Â∫∑')">
                <div class="category-icon">
                    <span class="icon">‚öΩ</span>
                </div>
                <span class="category-name">ÂÑøÁ´•ÂÅ•Â∫∑</span>
                <div class="category-tag">ÈÉ®ÂàÜÊª°78Âáè10</div>
            </div>
            <div class="category-card" onclick="goToCategory(3, 'Èò≤ÊöëÁî®ÂìÅ')">
                <div class="category-icon">
                    <span class="icon">‚òÄÔ∏è</span>
                </div>
                <span class="category-name">Èò≤ÊöëÁî®ÂìÅ</span>
                <div class="category-tag">ÈÉ®ÂàÜÊª°78Âáè10</div>
            </div>
            <div class="category-card" onclick="goToCategory(4, 'ÁöÆËÇ§Áî®ËçØ')">
                <div class="category-icon">
                    <span class="icon">ü©π</span>
                </div>
                <span class="category-name">ÁöÆËÇ§Áî®ËçØ</span>
                <div class="category-tag">ÈÉ®ÂàÜÊª°78Âáè10</div>
            </div>
        </div>

        <!-- ÂúÜÂΩ¢ÂàÜÁ±ªÂØºËà™ -->
        <div class="category-nav">
            <div class="category-item" onclick="goToCategory(5, 'ÊÑüÂÜíÂèëÁÉß')">
                <div class="category-icon-circle">
                    <span class="icon">ü§ß</span>
                </div>
                <span class="category-label">ÊÑüÂÜíÂèëÁÉß</span>
            </div>
            <div class="category-item" onclick="goToCategory(6, 'Âí≥ÂóΩÁî®ËçØ')">
                <div class="category-icon-circle">
                    <span class="icon">ü§í</span>
                </div>
                <span class="category-label">Âí≥ÂóΩÁî®ËçØ</span>
            </div>
            <div class="category-item" onclick="goToCategory(7, 'Ê∏ÖÁÉ≠Ëß£ÊØí')">
                <div class="category-icon-circle">
                    <span class="icon">üåø</span>
                </div>
                <span class="category-label">Ê∏ÖÁÉ≠Ëß£ÊØí</span>
            </div>
            <div class="category-item" onclick="goToCategory(8, 'ÁöÆËÇ§Áî®ËçØ')">
                <div class="category-icon-circle">
                    <span class="icon">üß¥</span>
                </div>
                <span class="category-label">ÁöÆËÇ§Áî®ËçØ</span>
            </div>
            <div class="category-item" onclick="goToCategory(9, 'ËÇ†ËÉÉÁî®ËçØ')">
                <div class="category-icon-circle">
                    <span class="icon">ü§¢</span>
                </div>
                <span class="category-label">ËÇ†ËÉÉÁî®ËçØ</span>
            </div>
            <div class="category-item" onclick="goToCategory(10, 'Â¶áÁßëÁî®ËçØ')">
                <div class="category-icon-circle">
                    <span class="icon">üå∫</span>
                </div>
                <span class="category-label">Â¶áÁßëÁî®ËçØ</span>
            </div>
            <div class="category-item" onclick="goToCategory(11, 'Áî∑ÁßëÁî®ËçØ')">
                <div class="category-icon-circle">
                    <span class="icon">üíä</span>
                </div>
                <span class="category-label">Áî∑ÁßëÁî®ËçØ</span>
            </div>
            <div class="category-item" onclick="goToCategory(12, 'ÂÑøÁ´•Áî®ËçØ')">
                <div class="category-icon-circle">
                    <span class="icon">üë∂</span>
                </div>
                <span class="category-label">ÂÑøÁ´•Áî®ËçØ</span>
            </div>
            <div class="category-item" onclick="goToCategory(13, 'ËÄ≥ÈºªÂñâËçØ')">
                <div class="category-icon-circle">
                    <span class="icon">üëÇ</span>
                </div>
                <span class="category-label">ËÄ≥ÈºªÂñâËçØ</span>
            </div>
            <div class="category-item" onclick="goToCategory(14, 'Èò≤ÊöëÈÅøÊöë')">
                <div class="category-icon-circle">
                    <span class="icon">üå°Ô∏è</span>
                </div>
                <span class="category-label">Èò≤ÊöëÈÅøÊöë</span>
            </div>
        </div>

        <!-- ÂïÜÂìÅÊé®Ëçê -->
        <div class="product-section">
            <div class="section-header">
                <span class="section-title">ÁÉ≠Èó®Êé®Ëçê</span>
                <span class="section-more" onclick="goToMore()">Êõ¥Â§ö ></span>
            </div>
            
            <!-- Âä†ËΩΩÁä∂ÊÄÅ -->
            <div id="productLoadingState" class="loading-state" style="display: none;">
                <div class="loading-spinner">‚è≥</div>
                <div class="loading-text">Ê≠£Âú®Âä†ËΩΩËçØÂìÅÊï∞ÊçÆ...</div>
            </div>
            
            <!-- ÈîôËØØÁä∂ÊÄÅ -->
            <div id="productErrorState" class="error-state" style="display: none;">
                <div class="error-icon">‚ùå</div>
                <div class="error-text">Âä†ËΩΩÂ§±Ë¥•ÔºåËØ∑Á®çÂêéÈáçËØï</div>
                <button class="retry-button" onclick="loadProductData()">ÈáçÊñ∞Âä†ËΩΩ</button>
            </div>
            
            <!-- ËçØÂìÅÂàóË°® -->
            <div id="productList" class="product-list">
                <!-- Âä®ÊÄÅÂä†ËΩΩÁöÑËçØÂìÅÊï∞ÊçÆÂ∞ÜÊòæÁ§∫Âú®ËøôÈáå -->
            </div>
        </div>

        <!-- Êñ∞‰∫∫‰∏ì‰∫´ -->
        <div class="new-user-banner" onclick="goToNewUserOffer()">
            <div class="banner-content">
                <span class="banner-text">Êñ∞‰∫∫‰∏ì‰∫´ÁâπÊÉ† ÂçïÂìÅ‰ΩéËá≥1ÂÖÉ</span>
                <span class="banner-more">Êõ¥Â§ö ></span>
            </div>
        </div>
    </div>

    <!-- Â∫ïÈÉ®ÂØºËà™Ê†è -->
    <div class="tabbar">
        <div class="tab-item active" onclick="switchTab('home')">
            <div class="tab-icon">üè†</div>
            <div class="tab-text">È¶ñÈ°µ</div>
        </div>
        <div class="tab-item" onclick="switchTab('mall')">
            <div class="tab-icon">üõí</div>
            <div class="tab-text">ÂèÆÂΩìÂïÜÂüé</div>
        </div>
        <div class="tab-item" onclick="switchTab('group')">
            <div class="tab-icon">üéØ</div>
            <div class="tab-text">Áâπ‰ª∑ÊãºÂõ¢</div>
        </div>
        <div class="tab-item" onclick="switchTab('cart')">
            <div class="tab-icon">üìã</div>
            <div class="tab-text">Ê∏ÖÂçïÂàóË°®</div>
            <div class="tab-badge">99</div>
        </div>
        <div class="tab-item" onclick="switchTab('user')">
            <div class="tab-icon">üë§</div>
            <div class="tab-text">ÊàëÁöÑ</div>
        </div>
    </div>

    <script>
        // È°µÈù¢Âä†ËΩΩÂÆåÊàêÂêéÁöÑÂàùÂßãÂåñ
        document.addEventListener('DOMContentLoaded', function() {
            console.log('È¶ñÈ°µÂä†ËΩΩÂÆåÊàê');
            loadData();
            loadProductData();
        });

        // Âä†ËΩΩÊï∞ÊçÆ
        function loadData() {
            console.log('È¶ñÈ°µÊï∞ÊçÆÂä†ËΩΩÂÆåÊàê');
        }

        // Âä†ËΩΩËçØÂìÅÊï∞ÊçÆ
        async function loadProductData() {
            const loadingState = document.getElementById('productLoadingState');
            const errorState = document.getElementById('productErrorState');
            const productList = document.getElementById('productList');

            try {
                // ÊòæÁ§∫Âä†ËΩΩÁä∂ÊÄÅ
                showLoadingState();

                console.log('üì¶ ÂºÄÂßãÂä†ËΩΩËçØÂìÅÊï∞ÊçÆ...');

                // Ë∞ÉÁî®ËçØÂìÅÂàóË°®API
                const response = await fetch('http://localhost:8888/v1/drug/list', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Accept': 'application/json'
                    },
                    body: JSON.stringify({
                        frist_category_id: 0,
                        second_category_id: 0,
                        keyword: ''
                    })
                });

                console.log('üì° APIÂìçÂ∫îÁä∂ÊÄÅ:', response.status);

                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }

                const data = await response.json();
                console.log('‚úÖ ËçØÂìÅÊï∞ÊçÆAPIÂìçÂ∫î:', data);
                console.log('üîç ËØ¶ÁªÜÊï∞ÊçÆÊ£ÄÊü•:');
                console.log('- data.drug:', data.drug);
                console.log('- data.drug.length:', data.drug ? data.drug.length : 'undefined');
                if (data.drug && data.drug.length > 0) {
                    console.log('- Á¨¨‰∏Ä‰∏™ËçØÂìÅÊï∞ÊçÆ:', data.drug[0]);
                    console.log('- Á¨¨‰∏Ä‰∏™ËçØÂìÅÁöÑdrug_name:', data.drug[0].drug_name);
                    console.log('- Á¨¨‰∏Ä‰∏™ËçØÂìÅÁöÑÊâÄÊúâÂ≠óÊÆµ:', Object.keys(data.drug[0]));
                }

                if (data.code != 0) {
                    throw new Error(data.msg || 'APIË∞ÉÁî®Â§±Ë¥•');
                }

                // ÊòæÁ§∫ËçØÂìÅÊï∞ÊçÆ
                displayProducts(data.drug || []);
                hideLoadingState();

            } catch (error) {
                console.error('‚ùå Âä†ËΩΩËçØÂìÅÊï∞ÊçÆÂ§±Ë¥•:', error);
                showErrorState();
            }
        }

        // ÊòæÁ§∫Âä†ËΩΩÁä∂ÊÄÅ
        function showLoadingState() {
            document.getElementById('productLoadingState').style.display = 'block';
            document.getElementById('productErrorState').style.display = 'none';
            document.getElementById('productList').style.display = 'none';
        }

        // ÊòæÁ§∫ÈîôËØØÁä∂ÊÄÅ
        function showErrorState() {
            document.getElementById('productLoadingState').style.display = 'none';
            document.getElementById('productErrorState').style.display = 'block';
            document.getElementById('productList').style.display = 'none';
        }

        // ÈöêËóèÂä†ËΩΩÁä∂ÊÄÅÔºåÊòæÁ§∫ËçØÂìÅÂàóË°®
        function hideLoadingState() {
            document.getElementById('productLoadingState').style.display = 'none';
            document.getElementById('productErrorState').style.display = 'none';
            document.getElementById('productList').style.display = 'flex';
        }

        // ÊòæÁ§∫ËçØÂìÅÊï∞ÊçÆ
        function displayProducts(drugs) {
            const productList = document.getElementById('productList');
            
            // Ê∑ªÂä†ËØ¶ÁªÜÁöÑË∞ÉËØï‰ø°ÊÅØ
            console.log('=== displayProducts ÂáΩÊï∞Ë∞ÉËØï ===');
            console.log('‰º†ÂÖ•ÁöÑdrugsÂèÇÊï∞:', drugs);
            console.log('drugsÁ±ªÂûã:', typeof drugs);
            console.log('ÊòØÂê¶‰∏∫Êï∞ÁªÑ:', Array.isArray(drugs));
            console.log('Êï∞ÁªÑÈïøÂ∫¶:', drugs ? drugs.length : 'undefined');
            
            if (!drugs || drugs.length === 0) {
                console.log('‚ùå Ê≤°ÊúâËçØÂìÅÊï∞ÊçÆÔºåÊòæÁ§∫Á©∫Áä∂ÊÄÅ');
                productList.innerHTML = `
                    <div style="text-align: center; padding: 40px; color: #999; width: 100%;">
                        <div style="font-size: 24px; margin-bottom: 10px;">üì¶</div>
                        <div>ÊöÇÊó†ËçØÂìÅÊï∞ÊçÆ</div>
                        <div style="font-size: 12px; color: #ccc; margin-top: 10px;">Ë∞ÉËØï: drugs=${drugs}, length=${drugs ? drugs.length : 'N/A'}</div>
                    </div>
                `;
                return;
            }

            // Âè™ÊòæÁ§∫Ââç4‰∏™ËçØÂìÅ‰Ωú‰∏∫ÁÉ≠Èó®Êé®Ëçê
            const displayDrugs = drugs.slice(0, 4);
            console.log('ÂáÜÂ§áÊòæÁ§∫ÁöÑËçØÂìÅ:', displayDrugs);
            
            const productsHTML = displayDrugs.map((drug, index) => {
                console.log(`Â§ÑÁêÜÁ¨¨${index + 1}‰∏™ËçØÂìÅ:`, drug);
                console.log(`- drug.drug_name:`, drug.drug_name);
                console.log(`- drug.specification:`, drug.specification);
                console.log(`- drug.price:`, drug.price);
                console.log(`- ÊâÄÊúâÂ≠óÊÆµ:`, Object.keys(drug));
                
                const drugName = drug.drugName || drug.drug_name || 'Êú™Áü•ËçØÂìÅ';
                const specification = drug.specification || 'ËßÑÊ†ºÂæÖÁ°ÆËÆ§';
                const price = drug.price ? drug.price.toFixed(2) : '0.00';
                const originalPrice = drug.price ? (drug.price * 1.2).toFixed(2) : '0.00';
                
                console.log(`- ÊúÄÁªàÊòæÁ§∫ÂêçÁß∞: "${drugName}"`);
                console.log(`- ÊúÄÁªàÊòæÁ§∫ËßÑÊ†º: "${specification}"`);
                
                // Ëé∑ÂèñËçØÂìÅIDÔºåÂ∞ùËØïÂ§öÁßçÂèØËÉΩÁöÑÂ≠óÊÆµÂêç
                const drugId = drug.id || drug.Id || index + 1;
                
                return `
                    <div class="product-item" onclick="goToProduct(${drugId})">
                        <div class="product-image-placeholder">üíä</div>
                        <div class="product-info">
                            <span class="product-name">${drugName}</span>
                            <span class="product-desc">${specification}</span>
                            <div class="product-price">
                                <span class="price">¬•${price}</span>
                                <span class="original-price">¬•${originalPrice}</span>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');

            productList.innerHTML = productsHTML;
            console.log(`‚úÖ Â∑≤ÊòæÁ§∫ ${displayDrugs.length} ‰∏™ËçØÂìÅ`);
            console.log('=== displayProducts ÂáΩÊï∞Ë∞ÉËØïÁªìÊùü ===');
        }

        // ÈÄâÊã©‰ΩçÁΩÆ
        function selectLocation() {
            alert('‰ΩçÁΩÆÈÄâÊã©ÂäüËÉΩÂºÄÂèë‰∏≠');
        }

        // Ë∑≥ËΩ¨Âà∞ÊêúÁ¥¢È°µ
        function goToSearch() {
            window.location.href = 'search.html';
        }

        // Ë∑≥ËΩ¨Âà∞ÈÄöÁü•È°µ
        function goToNotification() {
            window.location.href = 'notification.html';
        }

        // ÊåâÊ†áÁ≠æÊêúÁ¥¢
        function searchByTag(tag) {
            window.location.href = `search.html?keyword=${encodeURIComponent(tag)}`;
        }

        // ËΩÆÊí≠ÂõæÁÇπÂáª
        function handleBannerClick() {
            console.log('ÁÇπÂáªËΩÆÊí≠Âõæ');
            // Ê†πÊçÆbannerÁ±ªÂûãË∑≥ËΩ¨Âà∞Áõ∏Â∫îÈ°µÈù¢
        }

        // ÂåªÁîüÂú®Á∫øÂí®ËØ¢
        function goToDoctorConsultation() {
            window.location.href = 'doctor-list.html';
        }

        // ËçØÂ∏àÊåáÂØº
        function goToPharmacistGuidance() {
            alert('ËçØÂ∏àÊåáÂØºÂäüËÉΩÂºÄÂèë‰∏≠');
        }

        // Ë∑≥ËΩ¨Âà∞ÂàÜÁ±ªÈ°µ
        function goToCategory(id, name) {
            window.location.href = `category.html?id=${id}&name=${encodeURIComponent(name)}`;
        }

        // Ë∑≥ËΩ¨Âà∞ÂïÜÂìÅËØ¶ÊÉÖ
        function goToProduct(id) {
            if (!id || id === 'null') {
                console.error('ËçØÂìÅIDÊó†Êïà:', id);
                alert('ËçØÂìÅIDÊó†ÊïàÔºåÊó†Ê≥ïÊü•ÁúãËØ¶ÊÉÖ');
                return;
            }
            console.log('Ë∑≥ËΩ¨Âà∞ËçØÂìÅËØ¶ÊÉÖÈ°µÔºåID:', id);
            window.location.href = `product-detail.html?id=${id}`;
        }

        // Ë∑≥ËΩ¨Âà∞Êõ¥Â§öÈ°µÈù¢
        function goToMore() {
            window.location.href = 'product-list.html';
        }

        // Ë∑≥ËΩ¨Âà∞Êñ∞‰∫∫‰∏ì‰∫´
        function goToNewUserOffer() {
            window.location.href = 'new-user.html';
        }

        // Â∫ïÈÉ®ÂØºËà™Ê†èÂàáÊç¢
        function switchTab(tab) {
            // Ê†πÊçÆtabÁ±ªÂûãË∑≥ËΩ¨Âà∞Áõ∏Â∫îÈ°µÈù¢
            const pages = {
                'home': 'index.html',
                'mall': 'mall.html',
                'group': 'group.html',
                'cart': 'cart.html',
                'user': 'user.html'
            };
            
            const targetPage = pages[tab];
            if (targetPage && targetPage !== 'index.html') {
                // Áõ¥Êé•Ë∑≥ËΩ¨Âà∞ÂØπÂ∫îÈ°µÈù¢
                console.log(`ÂàáÊç¢Âà∞: ${targetPage}`);
                window.location.href = targetPage;
            }
        }
    </script>
</body>
</html>
