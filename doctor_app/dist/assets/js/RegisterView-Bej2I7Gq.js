var e=(e,s,a)=>new Promise((l,t)=>{var n=e=>{try{i(a.next(e))}catch(s){t(s)}},o=e=>{try{i(a.throw(e))}catch(s){t(s)}},i=e=>e.done?l(e.value):Promise.resolve(e.value).then(n,o);i((a=a.apply(e,s)).next())});/* empty css              */import{k as s,f as a,r as l,e as t,b as n,A as o,G as i,j as r,s as u,L as p,E as d,H as c,I as v,O as m,P as g,M as h,C as f}from"./vue-Djwh67vz.js";import{u as y,a as w,_ as b}from"./_plugin-vue_export-helper-DHCoCbLt.js";import"./index-C696E_os.js";import{v as k,a as x,F as C,g as j,d as I}from"./FeedbackButton-Dg577Pna.js";import{I as P,s as V}from"./vant-DqFfTfyr.js";import"./utils-C5DcNM9U.js";const _={class:"register-view"},S={class:"register-content"},U={class:"form-section"},E={class:"input-group phone-group"},F={class:"input-wrapper"},H={class:"input-group code-group"},L={class:"input-wrapper"},R=["disabled"],T={class:"input-group password-group"},z={class:"input-wrapper"},A=["type"],B={key:0,class:"password-strength"},D={class:"strength-bar"},G=b(s({__name:"RegisterView",setup(s){const b=y(),G=w(),M=a({phone:"",smsCode:"",password:""}),O=l(0),$=l(!1),q=l(!1),J=t(()=>!k(M.phone)||O.value>0||$.value),K=t(()=>O.value>0?`获取验证码(${O.value})`:"获取验证码"),N=t(()=>x(M.password)),Q=t(()=>{if(!M.password)return"";const e=N.value;return e.isValid?e.message.includes("很强")?"strong":e.message.includes("良好")?"medium":"weak":"weak"}),W=t(()=>{switch(Q.value){case"weak":return"33%";case"medium":return"66%";case"strong":return"100%";default:return"0%"}}),X=t(()=>N.value.message),Y=t(()=>k(M.phone)&&M.smsCode.length>=4&&N.value.isValid&&!$.value),Z=()=>{M.phone=M.phone.replace(/\D/g,"")},ee=()=>{q.value=!q.value},se=()=>e(this,null,function*(){if(J.value)return;const e=j(M.phone);if(e)V({message:e,type:"fail"});else try{$.value=!0,yield I.sendRegisterSms(M.phone),V({message:"验证码已发送",type:"success"}),ae()}catch(s){V({message:s.message||"发送验证码失败",type:"fail"})}finally{$.value=!1}}),ae=()=>{O.value=60;const e=setInterval(()=>{O.value--,O.value<=0&&clearInterval(e)},1e3)},le=()=>e(this,null,function*(){if(!Y.value)return;const e=x(M.password);if(e.isValid)try{$.value=!0,yield I.register({Phone:M.phone,Password:M.password,SendSmsCode:M.smsCode}),V({message:"注册成功，请登录",type:"success"}),setTimeout(()=>{ne()},1500)}catch(s){V({message:s.message||"注册失败",type:"fail"})}finally{$.value=!1}else V({message:e.message,type:"fail"})}),te=()=>{G.safePush("/login")},ne=()=>{G.safePush("/login")};return n(()=>{b.isLoggedIn&&b.checkTokenExpiry()&&G.toHome()}),(e,s)=>{const a=P;return f(),o("div",_,[i("div",S,[s[5]||(s[5]=i("div",{class:"header-section"},[i("h1",{class:"title"},"注册医生账号"),i("p",{class:"subtitle"},"欢迎使用优医在线问诊医生版")],-1)),i("div",U,[i("div",E,[i("div",F,[s[3]||(s[3]=i("span",{class:"country-code"},"+86",-1)),s[4]||(s[4]=i("div",{class:"divider"},null,-1)),u(i("input",{"onUpdate:modelValue":s[0]||(s[0]=e=>M.phone=e),type:"tel",placeholder:"请输入手机号码",class:"input-field",maxlength:"11",onInput:Z},null,544),[[p,M.phone]])])]),i("div",H,[i("div",L,[u(i("input",{"onUpdate:modelValue":s[1]||(s[1]=e=>M.smsCode=e),type:"number",placeholder:"请输入验证码",class:"input-field",maxlength:"6"},null,512),[[p,M.smsCode]]),i("button",{class:d(["code-button",{disabled:J.value}]),disabled:J.value,onClick:se},c(K.value),11,R)])]),i("div",T,[i("div",z,[u(i("input",{"onUpdate:modelValue":s[2]||(s[2]=e=>M.password=e),type:q.value?"text":"password",placeholder:"请输入密码",class:"input-field",maxlength:"20"},null,8,A),[[m,M.password]]),i("button",{class:"password-toggle",onClick:ee,type:"button"},[r(a,{name:q.value?"eye-o":"closed-eye"},null,8,["name"])])]),M.password?(f(),o("div",B,[i("div",D,[i("div",{class:d(["strength-fill",Q.value]),style:g({width:W.value})},null,6)]),i("span",{class:d(["strength-text",Q.value])},c(X.value),3)])):v("",!0)]),r(C,{text:"立即注册",type:"primary",size:"large",block:"",loading:$.value,disabled:!Y.value,onClick:le},null,8,["loading","disabled"]),i("div",{class:"login-link"},[i("span",{onClick:te},"已有账号，去登录")])]),s[6]||(s[6]=i("div",{class:"footer-section"},[i("p",{class:"footer-text"},[h(" 注册即代表您同意 "),i("span",{class:"link-text"},"优医在线问诊隐私政策")])],-1))])])}}}),[["__scopeId","data-v-bda6f98f"]]);export{G as default};
