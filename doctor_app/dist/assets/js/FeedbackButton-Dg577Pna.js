var e,t,r,o,s,a,n,l,i=Object.create,u=Object.defineProperty,d=Object.defineProperties,c=Object.getOwnPropertyDescriptor,g=Object.getOwnPropertyDescriptors,p=Object.getOwnPropertySymbols,h=Object.prototype.hasOwnProperty,m=Object.prototype.propertyIsEnumerable,v=(e,t)=>(t=Symbol[e])?t:Symbol.for("Symbol."+e),f=e=>{throw TypeError(e)},b=(e,t,r)=>t in e?u(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,y=(e,t)=>u(e,"name",{value:t,configurable:!0}),w=["class","method","getter","setter","accessor","field","value","get","set"],E=e=>void 0!==e&&"function"!=typeof e?f("Function expected"):e,R=(e,t,r,o,s)=>({kind:w[e],name:t,metadata:o,addInitializer:e=>r._?f("Already initialized"):s.push(E(e||null))}),S=(e,t)=>b(t,v("metadata"),e[3]),k=(e,t,r,o,s,a)=>{var n,l,i,d,g,p=7&t,h=!!(8&t),m=!!(16&t),v=p>3?e.length+1:p?h?1:2:0,b=w[p+5],k=p>3&&(e[v-1]=[]),O=e[v]||(e[v]=[]),I=p&&(!m&&!h&&(s=s.prototype),p<5&&(p>3||!m)&&c(p<4?s:{get[r](){return P(this,a)},set[r](e){return x(this,a,e)}},r));p?m&&p<4&&y(a,(p>2?"set ":p>1?"get ":"")+r):y(s,r);for(var C=o.length-1;C>=0;C--)d=R(p,r,i={},e[3],O),p&&(d.static=h,d.private=m,g=d.access={has:m?e=>L(s,e):e=>r in e},3^p&&(g.get=m?e=>(1^p?P:N)(e,s,4^p?a:I.get):e=>e[r]),p>2&&(g.set=m?(e,t)=>x(e,s,t,4^p?a:I.set):(e,t)=>e[r]=t)),l=(0,o[C])(p?p<4?m?a:I[b]:p>4?void 0:{get:I.get,set:I.set}:s,d),i._=1,4^p||void 0===l?E(l)&&(p>4?k.unshift(l):p?m?a=l:I[b]=l:s=l):"object"!=typeof l||null===l?f("Object expected"):(E(n=l.get)&&(I.get=n),E(n=l.set)&&(I.set=n),E(n=l.init)&&k.unshift(n));return p||S(e,s),I&&u(s,r,I),m?4^p?a:I:s},O=(e,t,r)=>b(e,"symbol"!=typeof t?t+"":t,r),I=(e,t,r)=>t.has(e)||f("Cannot "+r),L=(e,t)=>Object(t)!==t?f('Cannot use the "in" operator on this value'):e.has(t),P=(e,t,r)=>(I(e,t,"read from private field"),r?r.call(e):t.get(e)),x=(e,t,r,o)=>(I(e,t,"write to private field"),o?o.call(e,r):t.set(e,r),r),N=(e,t,r)=>(I(e,t,"access private method"),r),C=(e,t,r)=>new Promise((o,s)=>{var a=e=>{try{l(r.next(e))}catch(t){s(t)}},n=e=>{try{l(r.throw(e))}catch(t){s(t)}},l=e=>e.done?o(e.value):Promise.resolve(e.value).then(a,n);l((r=r.apply(e,t)).next())});import{a as A}from"./utils-C5DcNM9U.js";import{s as _,a as j,I as T}from"./vant-DqFfTfyr.js";/* empty css              */import{k as D,e as F,A as $,E as B,G as M,I as z,P as W,H as V,C as G,Q as U,r as K,R as H,S as q,n as J,M as Q}from"./vue-Djwh67vz.js";import{_ as X}from"./_plugin-vue_export-helper-DHCoCbLt.js";const Y=class e{constructor(){O(this,"errorLog",[]),O(this,"maxLogSize",100),this.setupGlobalHandlers()}static getInstance(){return e.instance||(e.instance=new e),e.instance}setupGlobalHandlers(){window.addEventListener("unhandledrejection",e=>{var t;this.handleError({type:"UNKNOWN",level:"ERROR",message:"系统发生未知错误",details:e.reason,timestamp:Date.now(),stack:null==(t=e.reason)?void 0:t.stack}),e.preventDefault()}),window.addEventListener("error",e=>{var t;this.handleError({type:"UNKNOWN",level:"ERROR",message:e.message||"脚本执行错误",details:{filename:e.filename,lineno:e.lineno,colno:e.colno},timestamp:Date.now(),stack:null==(t=e.error)?void 0:t.stack})}),window.addEventListener("error",e=>{var t,r,o;e.target!==window&&this.handleError({type:"NETWORK",level:"WARNING",message:"资源加载失败",details:{tagName:null==(t=e.target)?void 0:t.tagName,src:(null==(r=e.target)?void 0:r.src)||(null==(o=e.target)?void 0:o.href)},timestamp:Date.now()})},!0)}handleError(e){switch(this.addToLog(e),e.level){case"INFO":this.showInfoMessage(e.message);break;case"WARNING":this.showWarningMessage(e.message);break;case"ERROR":this.showErrorMessage(e.message);break;case"CRITICAL":this.showCriticalError(e)}this.reportError(e)}handleApiError(e){let t;if(e.response){const{status:r,data:o}=e.response;t={type:"API",level:this.getErrorLevelByStatus(r),message:this.getApiErrorMessage(r,null==o?void 0:o.Message),code:r,details:o,timestamp:Date.now()}}else t=e.request?{type:"NETWORK",level:"ERROR",message:"网络连接失败，请检查网络设置",details:e.request,timestamp:Date.now()}:{type:"UNKNOWN",level:"ERROR",message:e.message||"请求失败，请稍后重试",details:e,timestamp:Date.now(),stack:e.stack};return this.handleError(t),t.message}handleValidationError(e,t){const r={type:"VALIDATION",level:"WARNING",message:`${e}: ${t}`,timestamp:Date.now()};this.handleError(r)}handleAuthError(e="登录已过期，请重新登录"){const t={type:"AUTH",level:"ERROR",message:e,timestamp:Date.now()};this.handleError(t),setTimeout(()=>{localStorage.removeItem("doctor_token"),localStorage.removeItem("doctor_info"),window.location.href="/login"},1500)}getErrorLevelByStatus(e){return e>=500?"CRITICAL":e>=400?"ERROR":e>=300?"WARNING":"INFO"}getApiErrorMessage(e,t){return t||{400:"请求参数错误",401:"登录已过期，请重新登录",403:"没有权限访问",404:"请求的资源不存在",408:"请求超时",429:"请求过于频繁，请稍后再试",500:"服务器内部错误",502:"网关错误",503:"服务暂不可用",504:"网关超时"}[e]||`请求失败 (${e})`}showInfoMessage(e){_({message:e,type:"success",duration:2e3})}showWarningMessage(e){_({message:e,type:"fail",duration:3e3})}showErrorMessage(e){_({message:e,type:"fail",duration:4e3})}showCriticalError(e){j({title:"系统错误",message:`${e.message}\n\n如果问题持续存在，请联系技术支持。`,confirmButtonText:"确定",showCancelButton:!1})}addToLog(e){this.errorLog.unshift(e),this.errorLog.length>this.maxLogSize&&(this.errorLog=this.errorLog.slice(0,this.maxLogSize))}reportError(e){return C(this,null,function*(){})}getErrorLog(){return[...this.errorLog]}clearErrorLog(){this.errorLog=[],localStorage.removeItem("error_log")}exportErrorLog(){return JSON.stringify(this.errorLog,null,2)}};O(Y,"instance");const Z=Y.getInstance(),ee=A.create({baseURL:"/api",timeout:15e3,headers:{"Content-Type":"application/json"}});function te(e,t,r){const o=r.value;return r.value=function(...e){return C(this,null,function*(){try{return yield o.apply(this,e)}catch(t){throw t}})},r}ee.interceptors.request.use(e=>{const t=localStorage.getItem("doctor_token");var r,o;return t&&e.headers&&(e.headers.Authorization=`Bearer ${t}`),"get"===e.method&&(e.params=(r=((e,t)=>{for(var r in t||(t={}))h.call(t,r)&&b(e,r,t[r]);if(p)for(var r of p(t))m.call(t,r)&&b(e,r,t[r]);return e})({},e.params),o={_t:Date.now()},d(r,g(o)))),e},e=>Promise.reject(e)),ee.interceptors.response.use(e=>{const{data:t}=e;if(200===t.Code||0===t.Code)return t;{const e=new Error(t.Message||"请求失败");return e.name="BusinessError",Promise.reject(e)}},e=>{var t;const r=Z.handleApiError(e);return 401===(null==(t=e.response)?void 0:t.status)&&(localStorage.removeItem("doctor_token"),localStorage.removeItem("doctor_info"),setTimeout(()=>{"/login"!==window.location.pathname&&(window.location.href="/login")},1500)),e.message=r,Promise.reject(e)}),n=[te],a=[te],s=[te],o=[te],r=[te],t=[te],e=[te];class re{constructor(){((e,t,r,o)=>{for(var s=0,a=e[t>>1],n=a&&a.length;s<n;s++)1&t?a[s].call(r):o=a[s].call(r,o)})(l,5,this)}sendSms(e){return C(this,null,function*(){return ee.post("/v1/doctor/SendSms",e)})}login(e){return C(this,null,function*(){return ee.post("/v1/doctor/LoginDoctor",e)})}register(e){return C(this,null,function*(){return ee.post("/v1/doctor/RegisterDoctor",e)})}authentication(e){return C(this,null,function*(){return ee.post("/v1/doctor/Authentication",e)})}getProfile(e){return C(this,null,function*(){return ee.post("/v1/doctor/GetDoctorProfile",e)})}updateProfile(e){return C(this,null,function*(){return ee.post("/v1/doctor/UpdateDoctorProfile",e)})}changePassword(e){return C(this,null,function*(){return ee.post("/v1/doctor/ChangePassword",e)})}sendLoginSms(e){return C(this,null,function*(){return this.sendSms({Phone:e,SendSmsCode:"login"})})}sendRegisterSms(e){return C(this,null,function*(){return this.sendSms({Phone:e,SendSmsCode:"register"})})}sendResetPasswordSms(e){return C(this,null,function*(){return this.sendSms({Phone:e,SendSmsCode:"reset_password"})})}}var oe,se;k(l=[,,,i(null!=(se=null==(oe=null)?void 0:oe[v("metadata")])?se:null)],1,"sendSms",n,re),k(l,1,"login",a,re),k(l,1,"register",s,re),k(l,1,"authentication",o,re),k(l,1,"getProfile",r,re),k(l,1,"updateProfile",t,re),k(l,1,"changePassword",e,re),S(l,re);const ae=new re,ne=e=>/^1[3-9]\d{9}$/.test(e),le=e=>{if(!e)return{isValid:!1,message:"请输入密码"};if(e.length<6)return{isValid:!1,message:"密码长度不能少于6位"};if(e.length>20)return{isValid:!1,message:"密码长度不能超过20位"};if(/\s/.test(e))return{isValid:!1,message:"密码不能包含空格"};const t=/[a-zA-Z]/.test(e),r=/\d/.test(e);if(!t||!r)return{isValid:!1,message:"密码必须包含字母和数字"};const o=/[!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]/.test(e);return e.length>=8&&o?{isValid:!0,message:"密码强度很强"}:e.length>=8?{isValid:!0,message:"密码强度良好"}:{isValid:!0,message:"密码强度一般"}},ie=e=>e?(e=>/^\d{4,6}$/.test(e))(e)?"":"请输入4-6位数字验证码":"请输入验证码",ue={class:"spinner-container"},de={key:0,class:"loading-text"},ce=X(D({__name:"LoadingSpinner",props:{text:{},size:{default:"medium"},color:{default:"#007AFF"},overlay:{type:Boolean,default:!1},backgroundColor:{default:"rgba(255, 255, 255, 0.9)"}},setup(e){U(e=>({"5ebd6faa":e.backgroundColor}));const t=e,r=F(()=>`spinner-${t.size}`),o=F(()=>({borderTopColor:t.color,borderRightColor:t.color}));return(e,t)=>(G(),$("div",{class:B(["loading-spinner",{"loading-overlay":e.overlay}])},[M("div",ue,[M("div",{class:B(["spinner",r.value]),style:W(o.value)},null,6),e.text?(G(),$("p",de,V(e.text),1)):z("",!0)])],2))}}),[["__scopeId","data-v-f6b0e27a"]]),ge=["disabled"],pe={class:"button-content"},he={key:2,class:"button-text"},me=X(D({__name:"FeedbackButton",props:{text:{},type:{default:"primary"},size:{default:"medium"},icon:{},loading:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},block:{type:Boolean,default:!1},round:{type:Boolean,default:!1},hapticFeedback:{type:Boolean,default:!0},rippleEffect:{type:Boolean,default:!0}},emits:["click"],setup(e,{emit:t}){const r=e,o=t,s=K(!1),a=K(!1),n=K(null),l=F(()=>["feedback-button",`button-${r.type}`,`button-${r.size}`,{"button-block":r.block,"button-round":r.round,"button-loading":r.loading,"button-disabled":r.disabled,"button-pressed":s.value}]),i=F(()=>"outline"===r.type?"#007AFF":"#FFFFFF"),u=e=>C(this,null,function*(){r.disabled||r.loading||(r.hapticFeedback&&"vibrate"in navigator&&navigator.vibrate(10),r.rippleEffect&&(yield m(e)),o("click",e))}),d=()=>{r.disabled||r.loading||(s.value=!0)},c=()=>{s.value=!1},g=()=>{r.disabled||r.loading||(s.value=!0)},p=()=>{s.value=!1},h=()=>{s.value=!1},m=e=>C(this,null,function*(){const t=e.currentTarget.getBoundingClientRect(),r=Math.max(t.width,t.height),o=e.clientX-t.left-r/2,s=e.clientY-t.top-r/2;n.value={width:`${r}px`,height:`${r}px`,left:`${o}px`,top:`${s}px`},a.value=!0,yield J(),setTimeout(()=>{a.value=!1,n.value=null},600)});return(e,t)=>{const r=T;return G(),$("button",{class:B(l.value),disabled:e.disabled||e.loading,onClick:u,onTouchstart:d,onTouchend:c,onMousedown:g,onMouseup:p,onMouseleave:h},[M("div",pe,[e.loading?(G(),H(ce,{key:0,size:"small",color:i.value,class:"button-loading"},null,8,["color"])):e.icon?(G(),H(r,{key:1,name:e.icon,class:"button-icon"},null,8,["name"])):z("",!0),e.$slots.default||e.text?(G(),$("span",he,[q(e.$slots,"default",{},()=>[Q(V(e.text),1)])])):z("",!0)]),a.value&&n.value?(G(),$("div",{key:0,class:"button-ripple",style:W(n.value)},null,4)):z("",!0)],42,ge)}}}),[["__scopeId","data-v-6662eb81"]]);export{me as F,le as a,ae as d,ie as g,ne as v};
